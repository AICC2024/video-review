{"ast":null,"code":"var _jsxFileName = \"/Users/paulminton/development/video-review/video_review_backend/video_review_frontend/src/components/PdfRegionCommenter.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from \"react\";\nimport * as pdfjsLib from \"pdfjs-dist\";\nimport { GlobalWorkerOptions } from \"pdfjs-dist/build/pdf\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nGlobalWorkerOptions.workerSrc = \"/pdf.worker.mjs\";\nconst PdfRegionCommenter = ({\n  url\n}) => {\n  _s();\n  const containerRef = useRef(null);\n  const [pdf, setPdf] = useState(null);\n  useEffect(() => {\n    const loadPdf = async () => {\n      const loadingTask = pdfjsLib.getDocument(url);\n      const loadedPdf = await loadingTask.promise;\n      setPdf(loadedPdf);\n    };\n    loadPdf();\n  }, [url]);\n  useEffect(() => {\n    if (!pdf) return;\n    const renderPages = async () => {\n      const container = containerRef.current;\n      container.innerHTML = \"\"; // clear previous\n\n      for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {\n        const page = await pdf.getPage(pageNum);\n        const viewport = page.getViewport({\n          scale: 1.5\n        });\n        const canvas = document.createElement(\"canvas\");\n        canvas.width = viewport.width;\n        canvas.height = viewport.height;\n        canvas.style.border = \"1px solid #ccc\";\n        const context = canvas.getContext(\"2d\");\n        const renderContext = {\n          canvasContext: context,\n          viewport: viewport\n        };\n        await page.render(renderContext).promise;\n        const wrapper = document.createElement(\"div\");\n        wrapper.style.position = \"relative\";\n        wrapper.style.width = `${viewport.width}px`;\n        wrapper.style.height = `${viewport.height}px`;\n        wrapper.style.marginBottom = \"1rem\";\n        wrapper.style.boxShadow = \"0 0 6px rgba(0,0,0,0.1)\";\n        wrapper.style.backgroundColor = \"#fff\";\n        wrapper.style.borderRadius = \"4px\";\n        wrapper.style.padding = \"0.5rem\";\n        wrapper.appendChild(canvas);\n        const overlay = document.createElement(\"div\");\n        overlay.style.position = \"absolute\";\n        overlay.style.top = 0;\n        overlay.style.left = 0;\n        overlay.style.width = \"100%\";\n        overlay.style.height = \"100%\";\n        overlay.style.cursor = \"crosshair\";\n        wrapper.appendChild(overlay);\n        (function (pageNum) {\n          let isDragging = false;\n          let startX = 0;\n          let startY = 0;\n          let rect = null;\n          overlay.addEventListener(\"mousedown\", e => {\n            isDragging = true;\n            startX = e.offsetX;\n            startY = e.offsetY;\n\n            // Remove previous rectangle if it exists\n            if (rect && overlay.contains(rect)) {\n              overlay.removeChild(rect);\n            }\n            rect = document.createElement(\"div\");\n            rect.style.position = \"absolute\";\n            rect.style.border = \"2px solid red\";\n            rect.style.background = \"rgba(255,0,0,0.2)\";\n            rect.style.left = `${startX}px`;\n            rect.style.top = `${startY}px`;\n            overlay.appendChild(rect);\n          });\n          overlay.addEventListener(\"mousemove\", e => {\n            if (!isDragging || !rect) return;\n            const width = e.offsetX - startX;\n            const height = e.offsetY - startY;\n            rect.style.width = `${Math.abs(width)}px`;\n            rect.style.height = `${Math.abs(height)}px`;\n            rect.style.left = `${width < 0 ? e.offsetX : startX}px`;\n            rect.style.top = `${height < 0 ? e.offsetY : startY}px`;\n          });\n          overlay.addEventListener(\"mouseup\", e => {\n            isDragging = false;\n            if (rect) {\n              const x = parseFloat(rect.style.left);\n              const y = parseFloat(rect.style.top);\n              const w = parseFloat(rect.style.width);\n              const h = parseFloat(rect.style.height);\n              console.log(\"🖼️ Region drawn:\", {\n                x,\n                y,\n                w,\n                h,\n                pageNum\n              });\n              rect.title = `Page ${pageNum}\\nX: ${x}\\nY: ${y}\\nW: ${w}\\nH: ${h}`;\n            }\n          });\n        })(pageNum);\n        container.appendChild(wrapper);\n      }\n    };\n    renderPages();\n  }, [pdf]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      gap: \"1rem\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Storyboard Viewer with Region Comments (Experimental)\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: containerRef,\n      style: {\n        maxHeight: \"600px\",\n        overflowY: \"auto\",\n        border: \"1px solid #ccc\",\n        padding: \"1rem\",\n        backgroundColor: \"#fff\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this);\n};\n_s(PdfRegionCommenter, \"MPbMIj4N8I0qA4Z0YJbuP+YyQac=\");\n_c = PdfRegionCommenter;\nexport default PdfRegionCommenter;\nvar _c;\n$RefreshReg$(_c, \"PdfRegionCommenter\");","map":{"version":3,"names":["React","useRef","useEffect","useState","pdfjsLib","GlobalWorkerOptions","jsxDEV","_jsxDEV","workerSrc","PdfRegionCommenter","url","_s","containerRef","pdf","setPdf","loadPdf","loadingTask","getDocument","loadedPdf","promise","renderPages","container","current","innerHTML","pageNum","numPages","page","getPage","viewport","getViewport","scale","canvas","document","createElement","width","height","style","border","context","getContext","renderContext","canvasContext","render","wrapper","position","marginBottom","boxShadow","backgroundColor","borderRadius","padding","appendChild","overlay","top","left","cursor","isDragging","startX","startY","rect","addEventListener","e","offsetX","offsetY","contains","removeChild","background","Math","abs","x","parseFloat","y","w","h","console","log","title","display","flexDirection","gap","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","maxHeight","overflowY","_c","$RefreshReg$"],"sources":["/Users/paulminton/development/video-review/video_review_backend/video_review_frontend/src/components/PdfRegionCommenter.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from \"react\";\nimport * as pdfjsLib from \"pdfjs-dist\";\nimport { GlobalWorkerOptions } from \"pdfjs-dist/build/pdf\";\nGlobalWorkerOptions.workerSrc = \"/pdf.worker.mjs\";\n\nconst PdfRegionCommenter = ({ url }) => {\n  const containerRef = useRef(null);\n  const [pdf, setPdf] = useState(null);\n\n  useEffect(() => {\n    const loadPdf = async () => {\n      const loadingTask = pdfjsLib.getDocument(url);\n      const loadedPdf = await loadingTask.promise;\n      setPdf(loadedPdf);\n    };\n    loadPdf();\n  }, [url]);\n\n  useEffect(() => {\n    if (!pdf) return;\n\n    const renderPages = async () => {\n      const container = containerRef.current;\n      container.innerHTML = \"\"; // clear previous\n\n      for (let pageNum = 1; pageNum <= pdf.numPages; pageNum++) {\n        const page = await pdf.getPage(pageNum);\n        const viewport = page.getViewport({ scale: 1.5 });\n\n        const canvas = document.createElement(\"canvas\");\n        canvas.width = viewport.width;\n        canvas.height = viewport.height;\n        canvas.style.border = \"1px solid #ccc\";\n        const context = canvas.getContext(\"2d\");\n\n        const renderContext = {\n          canvasContext: context,\n          viewport: viewport\n        };\n\n        await page.render(renderContext).promise;\n\n        const wrapper = document.createElement(\"div\");\n        wrapper.style.position = \"relative\";\n        wrapper.style.width = `${viewport.width}px`;\n        wrapper.style.height = `${viewport.height}px`;\n        wrapper.style.marginBottom = \"1rem\";\n        wrapper.style.boxShadow = \"0 0 6px rgba(0,0,0,0.1)\";\n        wrapper.style.backgroundColor = \"#fff\";\n        wrapper.style.borderRadius = \"4px\";\n        wrapper.style.padding = \"0.5rem\";\n\n        wrapper.appendChild(canvas);\n\n        const overlay = document.createElement(\"div\");\n        overlay.style.position = \"absolute\";\n        overlay.style.top = 0;\n        overlay.style.left = 0;\n        overlay.style.width = \"100%\";\n        overlay.style.height = \"100%\";\n        overlay.style.cursor = \"crosshair\";\n        wrapper.appendChild(overlay);\n\n        (function(pageNum) {\n          let isDragging = false;\n          let startX = 0;\n          let startY = 0;\n          let rect = null;\n\n          overlay.addEventListener(\"mousedown\", (e) => {\n            isDragging = true;\n            startX = e.offsetX;\n            startY = e.offsetY;\n\n            // Remove previous rectangle if it exists\n            if (rect && overlay.contains(rect)) {\n              overlay.removeChild(rect);\n            }\n\n            rect = document.createElement(\"div\");\n            rect.style.position = \"absolute\";\n            rect.style.border = \"2px solid red\";\n            rect.style.background = \"rgba(255,0,0,0.2)\";\n            rect.style.left = `${startX}px`;\n            rect.style.top = `${startY}px`;\n            overlay.appendChild(rect);\n          });\n\n          overlay.addEventListener(\"mousemove\", (e) => {\n            if (!isDragging || !rect) return;\n            const width = e.offsetX - startX;\n            const height = e.offsetY - startY;\n            rect.style.width = `${Math.abs(width)}px`;\n            rect.style.height = `${Math.abs(height)}px`;\n            rect.style.left = `${width < 0 ? e.offsetX : startX}px`;\n            rect.style.top = `${height < 0 ? e.offsetY : startY}px`;\n          });\n\n          overlay.addEventListener(\"mouseup\", (e) => {\n            isDragging = false;\n            if (rect) {\n              const x = parseFloat(rect.style.left);\n              const y = parseFloat(rect.style.top);\n              const w = parseFloat(rect.style.width);\n              const h = parseFloat(rect.style.height);\n              console.log(\"🖼️ Region drawn:\", { x, y, w, h, pageNum });\n              rect.title = `Page ${pageNum}\\nX: ${x}\\nY: ${y}\\nW: ${w}\\nH: ${h}`;\n            }\n          });\n        })(pageNum);\n\n        container.appendChild(wrapper);\n      }\n    };\n\n    renderPages();\n  }, [pdf]);\n\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"column\", gap: \"1rem\" }}>\n      <h3>Storyboard Viewer with Region Comments (Experimental)</h3>\n      <div\n        ref={containerRef}\n        style={{\n          maxHeight: \"600px\",\n          overflowY: \"auto\",\n          border: \"1px solid #ccc\",\n          padding: \"1rem\",\n          backgroundColor: \"#fff\"\n        }}\n      />\n      {/* Additional app content like comment form or comment list goes here */}\n    </div>\n  );\n};\n\nexport default PdfRegionCommenter;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}